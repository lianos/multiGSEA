<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generates single sample gene set scores across a datasets by many methods — scoreSingleSamples • multiGSEA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Generates single sample gene set scores across a datasets by many methods — scoreSingleSamples" />
<meta property="og:description" content="It is common to assess the activity of a gene set in a given sample. There
are many ways to do that, and this method is analogous to the
multiGSEA() function in that it enables the user to run a multitude of
single-sample-gene-set-scoring algorithms over a target expression matrix
using a GeneSetDb() object." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multiGSEA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.99</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/multiGSEA.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generates single sample gene set scores across a datasets by many methods</h1>
    
    <div class="hidden name"><code>scoreSingleSamples.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>It is common to assess the activity of a gene set in a given sample. There
are many ways to do that, and this method is analogous to the
<code><a href='multiGSEA.html'>multiGSEA()</a></code> function in that it enables the user to run a multitude of
single-sample-gene-set-scoring algorithms over a target expression matrix
using a <code><a href='GeneSetDb-class.html'>GeneSetDb()</a></code> object.</p>
    </div>

    <pre class="usage"><span class='fu'>scoreSingleSamples</span><span class='op'>(</span>
  <span class='va'>gdb</span>,
  <span class='va'>y</span>,
  methods <span class='op'>=</span> <span class='st'>"ewm"</span>,
  as.matrix <span class='op'>=</span> <span class='cn'>FALSE</span>,
  drop.sd <span class='op'>=</span> <span class='fl'>1e-04</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  recenter <span class='op'>=</span> <span class='cn'>FALSE</span>,
  rescale <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>,
  as.dt <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gdb</th>
      <td><p>A GeneSetDb</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>An expression matrix to score genesets against</p></td>
    </tr>
    <tr>
      <th>methods</th>
      <td><p>A character vector that enumerates the scoring methods you
want to run over the samples. Please reference the "Single Sample Scoring
Methods" section for more information.</p></td>
    </tr>
    <tr>
      <th>as.matrix</th>
      <td><p>Return results as a list of matrices instead of a melted
data.frame? Defaults to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>drop.sd</th>
      <td><p>Genes with a standard deviation across columns in <code>y</code>
that is less than this value will be dropped.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>make some noise? Defaults to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>recenter, rescale</th>
      <td><p>If <code>TRUE</code>, the scores computed by each method
are centered and scaled using the <code>scale</code> function. These variables
correspond to the <code>center</code> and <code>scale</code> parameters in the
<code>scale</code> function. Defaults to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>these parameters are passed down into the the individual single
sample scoring funcitons to customize them further.</p></td>
    </tr>
    <tr>
      <th>as.dt</th>
      <td><p>If <code>FALSE</code> (default), the data.frame like thing that
this funciton returns will be set to a data.frame. Set this to <code>TRUE</code>
to keep this object as a <code>data.table</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A long data.frame with sample_id,method,score values per row. If
<code>as.matrix=TRUE</code>, a matrix with as many rows as <code><a href='geneSets.html'>geneSets(gdb)</a></code>
and as many columns as <code><a href='https://rdrr.io/r/base/nrow.html'>ncol(x)</a></code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Please refer to the "Generating Single Sample Gene Set Scores" of the
multiGSEA vignette for further exposition.</p>
    <h2 class="hasAnchor" id="single-sample-scoring-methods"><a class="anchor" href="#single-sample-scoring-methods"></a>Single Sample Scoring Methods</h2>

    

<p>The following <code>methods</code> are currenly provided.</p><ul>
<li><p><code>"ewm"</code>: The <code><a href='eigenWeightedMean.html'>eigenWeightedMean()</a></code> calculates the fraction each gene
contributes to a pre-specified principal component. These contributions
act as weights over each gene, which are then used in a simple weighted
mean calculation over all the genes in the geneset per sample. This is
similar, in spirit, to the svd/gsdecon method (ie. <code>method = "gsd"``) You can use this method to perform an "eigenweighted" zscore by setting </code>unscale<code>and</code>uncenter<code>to</code>FALSE<code>. </code>"ewz"<code>: with </code>unscale<code>and</code>uncenter<code>set to</code>FALSE`.</p></li>
<li><p><code>"gsd"</code>: This method was first introduced by Jason Hackney in
<a href='https://doi.org/10.1038/ng.3520'>doi:10.1038/ng.3520</a>. Please refer to
the <code><a href='gsdScore.html'>gsdScore()</a></code> function for more information.</p></li>
<li><p><code>"ssgsea"</code>: Using ssGSEA as implemented in the GSVA package.</p></li>
<li><p><code>"zscore"</code>: The features in the expression matrix are rowwise z transformed.
The gene set level score is then calculated by adding up the zscores for
the genes in the gene set, then dividing that number by either the the
size (or its sqaure root (default)) of the gene set.</p></li>
<li><p><code>"mean"</code>: Simply take the mean of the values from the expression matrix
that are in the gene set. Right or wrong, sometimes you just want the mean
without transforming the data.</p></li>
<li><p><code>"gsva"</code>: The gsva method of GSVA package.</p></li>
<li><p><code>"plage"</code>: Using "plage" as implemented in the GSVA package</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/hadley/reshape'>reshape2</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: package ‘reshape2’ was built under R version 4.0.2</span></div><div class='input'><span class='va'>gdb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='exampleExpressionSet.html'>exampleGeneSetDb</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>vm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='exampleExpressionSet.html'>exampleExpressionSet</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>scores</span> <span class='op'>&lt;-</span> <span class='fu'>scoreSingleSamples</span><span class='op'>(</span>
  <span class='va'>gdb</span>, <span class='va'>vm</span>, methods <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ewm"</span>, <span class='st'>"ssgsea"</span>, <span class='st'>"gsva"</span>, <span class='st'>"ewz"</span>, <span class='st'>"zscore"</span><span class='op'>)</span>,
  center <span class='op'>=</span> <span class='cn'>TRUE</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>, ssgsea.norm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: The current version of scoreSingleSamples produces *minor* differences in GSVA-based single sample gene set scores.</span>
#&gt; <span class='warning'>https://github.com/lianos/multiGSEA/issues/10</span></div><div class='output co'>#&gt; <span class='warning'>Warning: The current version of scoreSingleSamples produces *minor* differences in GSVA-based single sample gene set scores.</span>
#&gt; <span class='warning'>https://github.com/lianos/multiGSEA/issues/10</span></div><div class='input'>
<span class='va'>sw</span> <span class='op'>&lt;-</span> <span class='fu'>reshape2</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/reshape2/man/cast.html'>dcast</a></span><span class='op'>(</span><span class='va'>scores</span>, <span class='va'>name</span> <span class='op'>+</span> <span class='va'>sample_id</span> <span class='op'>~</span> <span class='va'>method</span>, value.var<span class='op'>=</span><span class='st'>'score'</span><span class='op'>)</span>

<span class='fu'><a href='corplot.html'>corplot</a></span><span class='op'>(</span><span class='va'>sw</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ewm"</span>, <span class='st'>"ssgsea"</span>, <span class='st'>"gsva"</span>, <span class='st'>"ewz"</span>, <span class='st'>"zscore"</span><span class='op'>)</span><span class='op'>]</span>,
        title <span class='op'>=</span> <span class='st'>"Single Sample Score Comparison"</span><span class='op'>)</span>
</div><div class='img'><img src='scoreSingleSamples-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># I think the eigenWeighteZscore is just ewm with un(center|scale) = FALSE</span>

<span class='va'>zs</span> <span class='op'>&lt;-</span> <span class='fu'>scoreSingleSamples</span><span class='op'>(</span>
  <span class='va'>gdb</span>, <span class='va'>vm</span>, methods <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'ewm'</span>, <span class='st'>'ewz'</span>, <span class='st'>'zscore'</span><span class='op'>)</span>, summary <span class='op'>=</span> <span class='st'>"mean"</span>,
  center <span class='op'>=</span> <span class='cn'>TRUE</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>, uncenter <span class='op'>=</span> <span class='cn'>FALSE</span>, unscale <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>zw</span> <span class='op'>&lt;-</span> <span class='fu'>reshape2</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/reshape2/man/cast.html'>dcast</a></span><span class='op'>(</span><span class='va'>zs</span>, <span class='va'>name</span> <span class='op'>+</span> <span class='va'>sample_id</span> <span class='op'>~</span> <span class='va'>method</span>, value.var<span class='op'>=</span><span class='st'>'score'</span><span class='op'>)</span>
<span class='fu'><a href='corplot.html'>corplot</a></span><span class='op'>(</span><span class='va'>zw</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ewm"</span>, <span class='st'>"ewz"</span>, <span class='st'>"zscore"</span><span class='op'>)</span><span class='op'>]</span>, title <span class='op'>=</span> <span class='st'>"EW zscores"</span><span class='op'>)</span>
</div><div class='img'><img src='scoreSingleSamples-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steve Lianoglou, Denali Therapeutics, Genentech.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


