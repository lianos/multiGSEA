<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Creates a "geneset smart" ComplexHeatmap::Heatmap — mgheatmap • multiGSEA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Creates a "geneset smart" ComplexHeatmap::Heatmap — mgheatmap" />
<meta property="og:description" content="Encapsulates many common &quot;moves&quot; you'll make when trying to make a heatmap,
especially if you are trying to show geneset activity across a panel of
samples.
NOTE: this function will almost certainly reorder the rows of the
input matrix. If you are concatentating Heatmap objects together horizontally
(ie. you if you want to use a rowAnnotation along side the returned heatmap),
you must reorder the rows of the annotation data.frame, ie.
ranno.df &amp;lt;- ranno.df[rownames(out@matrix),]" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multiGSEA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.13.15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/multiGSEA.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Creates a "geneset smart" ComplexHeatmap::Heatmap</h1>
    
    <div class="hidden name"><code>mgheatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Encapsulates many common "moves" you'll make when trying to make a heatmap,
especially if you are trying to show geneset activity across a panel of
samples.</p>
<p><strong>NOTE</strong>: this function will <strong>almost certainly</strong> reorder the rows of the
input matrix. If you are concatentating Heatmap objects together horizontally
(ie. you if you want to use a rowAnnotation along side the returned heatmap),
you must reorder the rows of the annotation data.frame, ie.
<code>ranno.df &lt;- ranno.df[rownames(out@matrix),]</code></p>
    </div>

    <pre class="usage"><span class='fu'>mgheatmap</span>(
  <span class='no'>x</span>,
  <span class='kw'>gdb</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>col</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>aggregate.by</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"none"</span>, <span class='st'>"ewm"</span>, <span class='st'>"ewz"</span>, <span class='st'>"zscore"</span>),
  <span class='kw'>split</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>scores</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>gs.order</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>name</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>rm.collection.prefix</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>rm.dups</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>recenter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>rescale</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>center</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>rename.rows</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>zero_center_colramp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>zlim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>transpose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>the data matrix</p></td>
    </tr>
    <tr>
      <th>gdb</th>
      <td><p><code>GeneSetDb</code> object that holds the genesets to plot. Defaults to
<code>NULL</code>, which will plot all rows in <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>a colorRamp(2) function</p></td>
    </tr>
    <tr>
      <th>aggregate.by</th>
      <td><p>the method used to generate single-sample geneset
scores. Default is <code>none</code> which plots heatmap at the gene level</p></td>
    </tr>
    <tr>
      <th>split</th>
      <td><p>introduce row-segmentation based on genesets or collections?
Defaults is <code>TRUE</code> which will create split heatmaps based on
collection if <code>aggregate.by != 'none'</code>, or based on gene sets
if <code>aggregate.by == "none"</code>.</p></td>
    </tr>
    <tr>
      <th>scores</th>
      <td><p>If <code>aggregate.by != "none"</code> you can pass in a precomupted
<code><a href='scoreSingleSamples.html'>scoreSingleSamples()</a></code> result, otherwise one will be
computed internally. Note that if this is a <code>data.frame</code> of
pre-computed scores, the <code>gdb</code> is largely irrelevant (but still
required).</p></td>
    </tr>
    <tr>
      <th>gs.order</th>
      <td><p>This is experimental, and is here to help order the order
of the genesets (or genesets collection) in a different way than the
default. By default, <code>gs.order = NULL</code> and genesets are enumerated in
alphabetical in the heatmap. You can pass in a character vector that will
dictate the order of the genesets displayed in the heatmap. Currently this
only matches against the <code>"name"</code> value of the geneset and probably only
works when <code>split = TRUE</code>. We will support <code>colleciton,name</code> tuples soon.
This can be a superset of the names found in <code>gdb</code>. As of ComplexHeatmap
v2 (maybe earlier versions), this doesn't really work when
<code>cluster_rows = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>rm.dups</th>
      <td><p>if <code>aggregate.by == 'none'</code>, do we remove genes that
appear in more than one geneset? Defaults to <code>FALSE</code></p></td>
    </tr>
    <tr>
      <th>recenter</th>
      <td><p>do you want to mean center the rows of the heatmap matrix
prior to calling <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>ComplexHeatmap::Heatmap()</a></code>?</p></td>
    </tr>
    <tr>
      <th>rescale</th>
      <td><p>do you want to standardize the row variance to one on the
values of the heatmap matrix prior to calling
<code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>ComplexHeatmap::Heatmap()</a></code>?</p></td>
    </tr>
    <tr>
      <th>rename.rows</th>
      <td><p>defaults to <code>NULL</code>, which induces no action. Specifying
a paramter here assumes you want to rename the rows of the heatmap.
Please refer to the "Renaming Rows" section for details.</p></td>
    </tr>
    <tr>
      <th>zero_center_colramp</th>
      <td><p>Used to specify the type of color ramp to generate
when <code>col</code> is <code>NULL</code>. By default (<code>NULL</code>) we try to guess if we should
generate a 0-centered (blue, white, red) color ramp, or an absolute
(viridis style) one. The guessing functionality isn't that great, so
it doesn't hurt to explicitly set this to <code>TRUE</code> or <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>zlim</th>
      <td><p>Used to control the color saturation of the heatmap when the
<code>col</code> parameter is not provided. If <code>NULL</code>, (default), extreme values
(outside the <code><a href='https://rdrr.io/r/base/c.html'>c(0.025, 0.975)</a></code> quantiles) are axed and the colorRamp is
based on the remaining value range. If <code>FALSE</code>, the range of the colorRamp
is defined by the min/max values. Otherwise a length(2) numeric can be
supplied. If the values are between <code>[0,1]</code>, then we assume this is a
quantile range to be calculated. Otherwise the number are assumed to
mark the top and bottom of the color scale range you want to use.</p></td>
    </tr>
    <tr>
      <th>transpose</th>
      <td><p>Flip display so that rows are columns. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>parameters to send down to <code><a href='scoreSingleSamples.html'>scoreSingleSamples()</a></code> or
<code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>ComplexHeatmap::Heatmap()</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>Heatmap</code> object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>More info here.</p>
    <h2 class="hasAnchor" id="renaming-heatmap-rows"><a class="anchor" href="#renaming-heatmap-rows"></a>Renaming Heatmap Rows</h2>

    

<p>This function leverages <code><a href='rename_rows.html'>rename_rows()</a></code> so that you can better customize the
output of your heatmaps by tweaking its rownames.</p>
<p>If you are plotting a <strong>gene-level</strong> heatmap (ie. <code>aggregate.by == "none"``) and the </code>rownames()<code>are gene identifiers, but you want the rownames of the heatmap to be gene symbols. You can perform this renaming using the</code>rename.rows` parameter.</p><ul>
<li><p>If <code>rename.rows</code> is <code>NULL</code>, then nothing is done.</p></li>
<li><p>If <code>rename.rows</code> is a <code>string</code>, then we assume that <code>x</code> has an associated
metadata <code>data.frame</code> over its rows and that <code>rename.rows</code> names one of
its columns, ie. <code>DGEList$genes[[rename.rows]]</code> or
<code>fData(ExpressionSet)[[rename.rows]]</code>. The values in that column will
be swapped out for <code>x</code>'s rownames</p></li>
<li><p>If <code>rename.rows</code> is a two-column data.frame, the first column is assumed
to be <code><a href='https://rdrr.io/r/base/colnames.html'>rownames(x)</a></code> and the second is what you want to rename it to.</p></li>
<li><p>When there are duplicates in the renamed rownames, the <code>rename.duplicates</code>
<code>...</code> parameter dictates the behavior. This will happen, for instance, if
you are trying to rename the rows of an affy matrix to gene symbols, where
we have multiple probe ids for one gene. When <code>rename.duplicates</code> is set to
<code>"original"</code>, one of the rows will get the new name, and the remaning
duplicate rows will keep the rownames they came in with. When set to
<code>"make.unique"</code>, the new names will contain <code>*.1</code>, <code>*.2</code>, etc. suffixes,
as you would get from using <code><a href='https://rdrr.io/r/base/make.unique.html'>base::make.unique()</a></code>.</p></li>
</ul>

<p>Maybe you are aggregating the expression scores into geneset scores, and
you don't want the rownames of the heatmap to be <code>collection;;name</code> (or just
<code>name</code> when <code>rm.collection.prefx = TRUE</code>), you can pass in a two column
<code>data.frame</code>, where the first column is <code>collection;name</code> and the second
is the name you want to rename that to. There is an example of this in
the "Examples" section here.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ComplexHeatmap</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: grid</span></div><div class='output co'>#&gt; <span class='message'>========================================</span>
#&gt; <span class='message'>ComplexHeatmap version 2.4.3</span>
#&gt; <span class='message'>Bioconductor page: http://bioconductor.org/packages/ComplexHeatmap/</span>
#&gt; <span class='message'>Github page: https://github.com/jokergoo/ComplexHeatmap</span>
#&gt; <span class='message'>Documentation: http://jokergoo.github.io/ComplexHeatmap-reference</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>If you use it in published research, please cite:</span>
#&gt; <span class='message'>Gu, Z. Complex heatmaps reveal patterns and correlations in multidimensional </span>
#&gt; <span class='message'>  genomic data. Bioinformatics 2016.</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>This message can be suppressed by:</span>
#&gt; <span class='message'>  suppressPackageStartupMessages(library(ComplexHeatmap))</span>
#&gt; <span class='message'>========================================</span></div><div class='input'><span class='no'>vm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='examples.html'>exampleExpressionSet</a></span>()
<span class='no'>gdb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='examples.html'>exampleGeneSetDb</a></span>()
<span class='no'>col.anno</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>ComplexHeatmap</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html'>HeatmapAnnotation</a></span>(
  <span class='kw'>df</span> <span class='kw'>=</span> <span class='no'>vm</span>$<span class='no'>targets</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Cancer_Status"</span>, <span class='st'>"PAM50subtype"</span>)],
  <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
    <span class='kw'>Cancer_Status</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>normal</span> <span class='kw'>=</span> <span class='st'>"grey"</span>, <span class='kw'>tumor</span> <span class='kw'>=</span> <span class='st'>"red"</span>),
    <span class='kw'>PAM50subtype</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>Basal</span> <span class='kw'>=</span> <span class='st'>"purple"</span>, <span class='kw'>Her2</span> <span class='kw'>=</span> <span class='st'>"green"</span>, <span class='kw'>LumA</span> <span class='kw'>=</span> <span class='st'>"orange"</span>)))
<span class='no'>mgh</span> <span class='kw'>&lt;-</span> <span class='fu'>mgheatmap</span>(<span class='no'>vm</span>, <span class='no'>gdb</span>, <span class='kw'>aggregate.by</span> <span class='kw'>=</span> <span class='st'>"ewm"</span>, <span class='kw'>split</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
                 <span class='kw'>top_annotation</span> <span class='kw'>=</span> <span class='no'>col.anno</span>, <span class='kw'>show_column_names</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                 <span class='kw'>column_title</span> <span class='kw'>=</span> <span class='st'>"Gene Set Activity in BRCA subset"</span>)

<span class='co'># Maybe you want the rownames of the matrix to use spaces instead of "_"</span>
<span class='no'>rr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='geneSets.html'>geneSets</a></span>(<span class='no'>gdb</span>)[, <span class='st'>"name"</span>, <span class='kw'>drop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>]
<span class='no'>rr</span>$<span class='no'>newname</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span>(<span class='st'>"_"</span>, <span class='st'>" "</span>, <span class='no'>rr</span>$<span class='no'>name</span>)
<span class='no'>mg2</span> <span class='kw'>&lt;-</span> <span class='fu'>mgheatmap</span>(<span class='no'>vm</span>, <span class='no'>gdb</span>, <span class='kw'>aggregate.by</span><span class='kw'>=</span><span class='st'>'ewm'</span>, <span class='kw'>split</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
                 <span class='kw'>top_annotation</span> <span class='kw'>=</span> <span class='no'>col.anno</span>, <span class='kw'>show_column_names</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                 <span class='kw'>column_title</span> <span class='kw'>=</span> <span class='st'>"Gene Set Activity in BRCA subset"</span>,
                 <span class='kw'>rename.rows</span> <span class='kw'>=</span> <span class='no'>rr</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steve Lianoglou, Denali Therapeutics, Genentech.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


