<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>A container for geneset definitions. — GeneSetDb-class • multiGSEA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="A container for geneset definitions. — GeneSetDb-class" />
<meta property="og:description" content="Please refer to the multiGSEA vignette (vignette(&quot;multiGSEA&quot;)),
(and the &quot;The GeneSetDb Class&quot; section, in particular) for a more deatiled
description of the sematnics of this central data object.
The GeneSetDb class serves the same purpose as the
GSEABase::GeneSetCollection() class does: it acts as a centralized
object to hold collections of Gene Sets. The reason for its existence is
because there are things that I wanted to know about my gene set
collections that weren't easily inferred from what is essentially a
&quot;list of GeneSets&quot; that is the GeneSetCollection class.
Gene Sets are internally represented by a data.table in &quot;a tidy&quot;
format, where we minimally require non NA values for the following
three character columns:
collection
name
feature_id


The (collection, name) compound key is the primary key of a gene set.
There will be as many entries with the same (collection, name) as there
are genes/features in that set.
The GeneSetDb tracks metadata about genesets at the collection
level. This means that we assume that all of the feature_id's used
within a collection use the same type of feature identifier (such as
a GSEABase::EntrezIdentifier(), were defined in the same organism,
etc.
Please refer to the &quot;GeneSetDb&quot; section of the vignette for more
details regarding the construction and querying of a GeneSetDb object." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multiGSEA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.13.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/multiGSEA.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A container for geneset definitions.</h1>
    
    <div class="hidden name"><code>GeneSetDb-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Please refer to the multiGSEA vignette (<code><a href='../articles/multiGSEA.html'>vignette("multiGSEA")</a></code>),
(and the "The GeneSetDb Class" section, in particular) for a more deatiled
description of the sematnics of this central data object.</p>
<p>The GeneSetDb class serves the same purpose as the
<code><a href='https://rdrr.io/pkg/GSEABase/man/GeneSetCollection-methods.html'>GSEABase::GeneSetCollection()</a></code> class does: it acts as a centralized
object to hold collections of Gene Sets. The reason for its existence is
because there are things that I wanted to know about my gene set
collections that weren't easily inferred from what is essentially a
"list of GeneSets" that is the <code>GeneSetCollection</code> class.</p>
<p>Gene Sets are internally represented by a <code>data.table</code> in "a tidy"
format, where we minimally require non <code>NA</code> values for the following
three <code>character</code> columns:</p><ul>
<li><p>collection</p></li>
<li><p>name</p></li>
<li><p>feature_id</p></li>
</ul>

<p>The (<code>collection</code>, <code>name</code>) compound key is the primary key of a gene set.
There will be as many entries with the same (<code>collection</code>, <code>name</code>) as there
are genes/features in that set.</p>
<p>The <code>GeneSetDb</code> tracks metadata about genesets at <strong>the collection</strong>
level. This means that we assume that all of the <code>feature_id</code>'s used
within a collection use the same type of feature identifier (such as
a <code><a href='https://rdrr.io/pkg/GSEABase/man/GeneIdentifierType-constructors.html'>GSEABase::EntrezIdentifier()</a></code>, were defined in the same organism,
etc.</p>
<p><strong>Please refer to the "GeneSetDb" section of the vignette</strong> for more
details regarding the construction and querying of a <code>GeneSetDb</code> object.</p>
    </div>

    <pre class="usage"><span class='fu'>GeneSetDb</span>(<span class='no'>x</span>, <span class='kw'>featureIdMap</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>collectionName</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A <code>GeneSetCollection</code>, a "two deep" list of either
<code>GeneSetCollection</code>s or lists of character vectors, which are
the gene identifers. The "two deep" list represents the different
collections (top level) at the top level, and each such list is a named
list itself, which represents the gene sets in the given collection.</p></td>
    </tr>
    <tr>
      <th>featureIdMap</th>
      <td><p>A data.frame with  2 character columns. The first
column is the ids of the genes (features) used to identify the genes in
<code>gene.sets</code>, the second second column are IDs that this should be mapped
to. Useful for testing probelevel microarray data to gene level gene set
information.</p></td>
    </tr>
    <tr>
      <th>collectionName</th>
      <td><p>If <code>x</code> represents a singular collection, ie.
a single <code>GeneSetCollection</code> or a "one deep" (named (by geneset))
list of genesets, then this parameter provides the name for the
collection. If <code>x</code> is multiple collections, this can be character
vector of same length with the names. In all cases, if a collection name
can't be defined from this, then collections will be named anonymously.
If a value is passed here, it will overide any names stored in the list of
<code>x</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl'>
<dt><code>table</code></dt><dd><p>The "gene set table": a data.table with geneset information,
one row per gene set. Columns include collection, name, N, and n. The end
user can add more columns to this data.table as desired. The actual
feature IDs are computed on the fly by doing a <code>db[J(group, id)]</code></p></dd>

<dt><code>db</code></dt><dd><p>A <code>data.table</code> to hold all of the original geneset id
information that was used to construct this <code>GeneSetDb</code>.</p></dd>

<dt><code>featureIdMap</code></dt><dd><p>Maps the ids used in the geneset lists to the ids
(rows) over the expression data the GSEA is run on</p></dd>

<dt><code>collectionMetadata</code></dt><dd><p>A <code>data.table</code> to keep metadata about each
individual geneset collection, ie. the user might want to keep track of
where the geneset definitions come from. Perhaps a function that parses
the collection,name combination to generate an URL that points the user
to more information about that geneset, etc.</p></dd>

</dl>
    <h2 class="hasAnchor" id="genesetdb-construction"><a class="anchor" href="#genesetdb-construction"></a>GeneSetDb Construction</h2>

    


<p>The <code>GeneSetDb()</code> constructor is sufficiently flexible enough to create
a <code>GeneSetDb</code> object from a variety of formats that are commonly used
in the bioconductor echosystem, such as:</p><ul>
<li><p><code><a href='https://rdrr.io/pkg/GSEABase/man/GeneSetCollection-methods.html'>GSEABase::GeneSetCollection()</a></code>: If you already have a <code>GeneSetCollection</code>
on your hands, you can simply pass it to the <code>GeneSetDb()</code> constructor.</p></li>
<li><p>list of ids: This format is commonly used to define gene sets in the
edgeR/limma universe for testing with camera, roast, romer, etc. The names
of the list items are the gene set names, and their values are a character
vector of gene identifiers. When it's a single list of lists, you must
provide a value for <code>collectionName</code>. You can embed multiple
collections of gene sets by having a three-deep list-of-lists-of-ids.
The top level list define the different collections, the second level
are the genesets, and the third level are the feature identifiers for
each gene set. See the examples for clarification.</p></li>
<li><p>a <code>data.frame</code>-like object: To keep track of your own custom gene sets, you
have probably realized the importance of maintaing your own sanity, and
likely have gene sets organized in a table like object that has something
like the <code>collection</code>, <code>name</code>, and <code>feature_id</code> required for a <code>GeneSetDb</code>.
Simply rename the appropriate columns to the ones prescribed here, and pass
that into the constructor. Any other additional columns (symbol, direction,
etc.) will be copied into the <code>GeneSetDb</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="interrogating-a-genesetdb"><a class="anchor" href="#interrogating-a-genesetdb"></a>Interrogating a GeneSetDb</h2>

    


<p>You might wonder what gene sets are defined in a <code>GeneSetDb</code>: see
the <code><a href='geneSets.html'>geneSets()</a></code> function.</p>
<p>Curious about what features are defined in your <code>GeneSetDb</code>? See
the <code><a href='featureIds.html'>featureIds()</a></code> function.</p>
<p>Want the details of a particular gene set? Try the <code><a href='geneSet.html'>geneSet()</a></code> function.
This will return a <code>data.frame</code> of the gene set definition. Calling
<code><a href='geneSet.html'>geneSet()</a></code> on a <code><a href='MultiGSEAResult.html'>MultiGSEAResult()</a></code> will return the same <code>data.frame</code> along
with the differential expression statistics for the individual members of the
geneSet across the contrast that was tested in the <code><a href='multiGSEA.html'>multiGSEA()</a></code> call that
created the <code><a href='MultiGSEAResult.html'>MultiGSEAResult()</a></code>.</p>
    <h2 class="hasAnchor" id="genesetdb-manipulation"><a class="anchor" href="#genesetdb-manipulation"></a>GeneSetDb manipulation</h2>

    


<p>You can subset a GeneSetDb to include a subset of genesets defined in it.
To do this, you need to provide an indexing vector that is as long as
<code><a href='https://rdrr.io/r/base/length.html'>length(gdb)</a></code>, ie. the number of gene sets defined in GeneSetDb. You
can construct such a vector by performing your boolean logic over the
<code><a href='geneSets.html'>geneSets(gdb)</a></code> table.</p>
<p>Look at the Examples section to see how this works, where we take the
MSIgDB c7 collection (aka. "ImmuneSigDB") and only keep gene sets that
were defined in experiments from mouse.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='conversion.html'>?conversion</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## exampleGeneSetDF provides gene set definitions in "long form". We show</span>
<span class='co'>## how this can easily turned into a GeneSetDb from this form, or convert</span>
<span class='co'>## it to other forms (list of features, or list of list of features) to</span>
<span class='co'>## do the same.</span>
<span class='no'>gs.df</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='examples.html'>exampleGeneSetDF</a></span>()
<span class='no'>gdb.df</span> <span class='kw'>&lt;-</span> <span class='fu'>GeneSetDb</span>(<span class='no'>gs.df</span>)

<span class='co'>## list of ids</span>
<span class='no'>gs.df</span>$<span class='no'>key</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gskey.html'>encode_gskey</a></span>(<span class='no'>gs.df</span>)
<span class='no'>gs.list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span>(<span class='no'>gs.df</span>$<span class='no'>feature_id</span>, <span class='no'>gs.df</span>$<span class='no'>key</span>)
<span class='no'>gdb.list</span> <span class='kw'>&lt;-</span> <span class='fu'>GeneSetDb</span>(<span class='no'>gs.list</span>, <span class='kw'>collectionName</span><span class='kw'>=</span><span class='st'>'custom-sigs'</span>)

<span class='co'>## A list of lists, where the top level list splits the collections.</span>
<span class='co'>## The name of the collection in the GeneSetDb is taken from this top level</span>
<span class='co'>## hierarchy</span>
<span class='no'>gs.lol</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='conversion.html'>as.list</a></span>(<span class='no'>gdb.df</span>, <span class='kw'>nested</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'>## examine this list-of lists</span>
<span class='no'>gdb.lol</span> <span class='kw'>&lt;-</span> <span class='fu'>GeneSetDb</span>(<span class='no'>gs.lol</span>) <span class='co'>## note that collection is set propperly</span>

<span class='co'>## GeneSetDb Interrogation</span>
<span class='no'>gsets</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='geneSets.html'>geneSets</a></span>(<span class='no'>gdb.df</span>)
<span class='no'>nkcells</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='geneSet.html'>geneSet</a></span>(<span class='no'>gdb.df</span>, <span class='st'>'cellularity'</span>, <span class='st'>'NK cells'</span>)
<span class='no'>fids</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='featureIds.html'>featureIds</a></span>(<span class='no'>gdb.df</span>)

<span class='co'># GeneSetDb Manipulation ....................................................</span>
<span class='co'># Subset ImmuneSigDB down to only gene sets defined from mouse</span>
<span class='co'># NOTE: This doesn't work with updated MSigDB collections</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>idb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getMSigGeneSetDb.html'>getMSigGeneSetDb</a></span>(<span class='st'>'c7'</span>, <span class='st'>'mouse'</span>)
<span class='no'>igs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='geneSets.html'>geneSets</a></span>(<span class='no'>idb</span>)
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>igs</span>$<span class='no'>organism</span>)
<span class='co'>## Homo sapiens Mus musculus</span>
<span class='co'>##         1888         2984</span>
<span class='no'>idb.mm</span> <span class='kw'>&lt;-</span> <span class='no'>idb</span>[<span class='no'>igs</span>$<span class='no'>organism</span> <span class='kw'>==</span> <span class='st'>'Mus musculus'</span>]
<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>idb.mm</span>) <span class='co'>## 2984</span>
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steve Lianoglou, Denali Therapeutics, Genentech.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


