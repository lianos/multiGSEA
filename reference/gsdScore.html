<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Single sample geneset score using SVD based eigengene value per sample. — gsdScore • multiGSEA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Single sample geneset score using SVD based eigengene value per sample. — gsdScore" />
<meta property="og:description" content="This method was developed by Jason Hackney and first introduced in the
following paper doi:10.1038/ng.3520.
It produces a single sample gene set score in values that are in
&quot;expression space,&quot; the innards of which mimic something quite similar
to an eigengene based score.
To easily use this method to score a number of gene setes across an
experiment, you'll want to have the scoreSingleSamples() method
drive this function via specifying &quot;svd&quot; as one of the
methods." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multiGSEA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.13.15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/multiGSEA.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Single sample geneset score using SVD based eigengene value per sample.</h1>
    
    <div class="hidden name"><code>gsdScore.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This method was developed by Jason Hackney and first introduced in the
following paper <a href='https://doi.org/10.1038/ng.3520'>doi:10.1038/ng.3520</a>.
It produces a single sample gene set score in values that are in
"expression space," the innards of which mimic something quite similar
to an eigengene based score.</p>
<p>To easily use this method to score a number of gene setes across an
experiment, you'll want to have the <code><a href='scoreSingleSamples.html'>scoreSingleSamples()</a></code> method
drive this function via specifying <code>"svd"</code> as one of the
<code>methods</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>gsdScore</span><span class='op'>(</span>
  <span class='va'>x</span>,
  eigengene <span class='op'>=</span> <span class='fl'>1L</span>,
  center <span class='op'>=</span> <span class='cn'>TRUE</span>,
  scale <span class='op'>=</span> <span class='cn'>TRUE</span>,
  uncenter <span class='op'>=</span> <span class='va'>center</span>,
  unscale <span class='op'>=</span> <span class='va'>scale</span>,
  retx <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>,
  .use_irlba <span class='op'>=</span> <span class='cn'>FALSE</span>,
  .drop.sd <span class='op'>=</span> <span class='fl'>1e-04</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An expression matrix of genes x samples. When using this to score
geneset activity, you want to reduce the rows of <code>x</code> to be only the
genes from the given gene set.</p></td>
    </tr>
    <tr>
      <th>eigengene</th>
      <td><p>the "eigengene" you want to get the score for. only accepts
a single value for now.</p></td>
    </tr>
    <tr>
      <th>center, scale</th>
      <td><p>center and/or scale data before scoring?</p></td>
    </tr>
    <tr>
      <th>uncenter, unscale</th>
      <td><p>uncenter and unscale the data data on the way out?
Defaults to the respective values of <code>center</code> and <code>scale</code></p></td>
    </tr>
    <tr>
      <th>retx</th>
      <td><p>Works the same as <code>retx</code> from <code><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></code>. If
<code>TRUE</code>, will return a <code>ret$pca$x</code> matrix that has the rotated
variables.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>these aren't used in here</p></td>
    </tr>
    <tr>
      <th>.drop.sd</th>
      <td><p>When zero-sd (non varying) features are scaled, their values
are <code>NaN</code>. When the Features with rowSds &lt; this threshold (default 1e-4) are
identified, and their scaled values are set to 0.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of useful transformation information. The caller is likely
most interested in the <code>$score</code> vector, but other bits related to
the SVD/PCA decomposition are included for the ride.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The difference between this method vs the eigengene score is that the SVD is
used to calculate the eigengene. The vector of eigengenes (one score per
sample) is then multiplied through by the SVD's left matrix. This produces a
matrix which we then take the colSums of to get back to a single sample
score for the geneset.</p>
<p>Why do all of that? You get data that is back "in expression space" and we
also run around the problem of sign of the eigenvector. The scores you get
are very similar to average zscores of the genes per sample, where the
average is weighted by the degree to which each gene contributes to the
principal component chosen by <code>eigengene</code>, as implemented in the
<code><a href='eigenWeightedMean.html'>eigenWeightedMean()</a></code> function.</p>
<p><em>The core functionality provided here is taken from the soon to be
released GSDecon package by Jason Hackney</em></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>vm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='exampleExpressionSet.html'>exampleExpressionSet</a></span><span class='op'>(</span>do.voom<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>gdb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='conform.html'>conform</a></span><span class='op'>(</span><span class='fu'><a href='getMSigGeneSetDb.html'>getMSigGeneSetDb</a></span><span class='op'>(</span><span class='st'>'H'</span>, <span class='st'>"human"</span>, <span class='st'>"entrez"</span><span class='op'>)</span>, <span class='va'>vm</span><span class='op'>)</span>
<span class='va'>features</span> <span class='op'>&lt;-</span> <span class='fu'><a href='featureIds.html'>featureIds</a></span><span class='op'>(</span><span class='va'>gdb</span>, <span class='st'>'H'</span>, <span class='st'>'HALLMARK_INTERFERON_GAMMA_RESPONSE'</span>,
                       value<span class='op'>=</span><span class='st'>'x.idx'</span><span class='op'>)</span>
<span class='va'>scores</span> <span class='op'>&lt;-</span> <span class='fu'>gsdScore</span><span class='op'>(</span><span class='va'>vm</span><span class='op'>[</span><span class='va'>features</span>,<span class='op'>]</span><span class='op'>)</span><span class='op'>$</span><span class='va'>score</span>

<span class='co'>## Use scoreSingleSamples to facilitate scoring of all gene sets</span>
<span class='va'>scores.all</span> <span class='op'>&lt;-</span> <span class='fu'><a href='scoreSingleSamples.html'>scoreSingleSamples</a></span><span class='op'>(</span><span class='va'>gdb</span>, <span class='va'>vm</span>, <span class='st'>'gsd'</span><span class='op'>)</span>
<span class='va'>s2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>scores.all</span>, <span class='va'>name</span> <span class='op'>==</span> <span class='st'>'HALLMARK_INTERFERON_GAMMA_RESPONSE'</span><span class='op'>)</span>,
           <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span><span class='va'>score</span>, <span class='va'>sample_id</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>s2</span>, <span class='va'>scores</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steve Lianoglou, Denali Therapeutics, Genentech.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


