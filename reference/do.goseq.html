<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Performs goseq analysis significance of gene set membership. — do.goseq • multiGSEA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Performs goseq analysis significance of gene set membership. — do.goseq" />
<meta property="og:description" content="Genes are selected for testing against each geneset by virture of them
passing a maximum FDR and minimum log fold change as perscribed by the
min.logFC and max.padj parameters, respectfully." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">multiGSEA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.99</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/multiGSEA.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Performs goseq analysis significance of gene set membership.</h1>
    
    <div class="hidden name"><code>do.goseq.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Genes are selected for testing against each geneset by virture of them
passing a maximum FDR and minimum log fold change as perscribed by the
<code>min.logFC</code> and <code>max.padj</code> parameters, respectfully.</p>
    </div>

    <pre class="usage"><span class='fu'>do.goseq</span><span class='op'>(</span>
  <span class='va'>gsd</span>,
  <span class='va'>x</span>,
  <span class='va'>design</span>,
  contrast <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>design</span><span class='op'>)</span>,
  <span class='va'>feature.bias</span>,
  goseq.method <span class='op'>=</span> <span class='st'>"Wallenius"</span>,
  repcnt <span class='op'>=</span> <span class='fl'>2000</span>,
  use_genes_without_cat <span class='op'>=</span> <span class='cn'>TRUE</span>,
  split.updown <span class='op'>=</span> <span class='cn'>TRUE</span>,
  direction <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"over"</span>, <span class='st'>"under"</span><span class='op'>)</span>,
  plot.fit <span class='op'>=</span> <span class='cn'>FALSE</span>,
  use.treat <span class='op'>=</span> <span class='cn'>FALSE</span>,
  feature.min.logFC <span class='op'>=</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>use.treat</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log2</a></span><span class='op'>(</span><span class='fl'>1.25</span><span class='op'>)</span> <span class='kw'>else</span> <span class='fl'>1</span>,
  feature.max.padj <span class='op'>=</span> <span class='fl'>0.1</span>,
  logFC <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gsd</th>
      <td><p>The <code><a href='GeneSetDb-class.html'>GeneSetDb</a></code> for analysis</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>The expression object</p></td>
    </tr>
    <tr>
      <th>design</th>
      <td><p>Experimental design</p></td>
    </tr>
    <tr>
      <th>contrast</th>
      <td><p>The contrast to test</p></td>
    </tr>
    <tr>
      <th>feature.bias</th>
      <td><p>a named vector as long as <code><a href='https://rdrr.io/r/base/nrow.html'>nrow(x)</a></code> that has the
"bias" information for the features/genes tested (ie. vector of gene
lengths). <code><a href='https://rdrr.io/r/base/names.html'>names(feature.bias)</a></code> should equal <code><a href='https://rdrr.io/r/base/colnames.html'>rownames(x)</a></code>.
The caller MUST provide this. The goseq package provides a
<code><a href='https://rdrr.io/pkg/goseq/man/getlength.html'>getlength</a></code> function which facilitates getting default
values for these if you do not have the correct values used in your
analysis. If there is no way for you to get this information, then use
ora with no <code>feature.bias</code> vector.</p></td>
    </tr>
    <tr>
      <th>repcnt</th>
      <td><p>Number of random samples to be calculated when random sampling
is used. Ignored unless <code>method="Sampling"</code>.</p></td>
    </tr>
    <tr>
      <th>use_genes_without_cat</th>
      <td><p>A boolean to indicate whether genes without a
categorie should still be used. For example, a large number of gene may
have no GO term annotated. If this option is set to FALSE, those genes
will be ignored in the calculation of p-values (default behaviour). If
this option is set to TRUE, then these genes will count towards the total
number of genes outside the category being tested.</p></td>
    </tr>
    <tr>
      <th>direction</th>
      <td><p>Same as direction in <code>GOstats</code></p></td>
    </tr>
    <tr>
      <th>plot.fit</th>
      <td><p>To plot (or not) the bias in selected genes vs.
<code>feature.bias</code>.</p></td>
    </tr>
    <tr>
      <th>logFC</th>
      <td><p>The logFC data.table from <code>calculateIndividualLogFC</code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments to pass down into <code>calculateIndividualLogFC</code></p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The method to use to calculate the unbiased category
enrichment scores</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.table of goseq results. The "pval" column here refers to
pval.over, for simplicity in other places. If <code>split.updown=TRUE</code>,
a list of data.table's are returned named 'goseq', 'goseq.up', and
'goseq.down' which are the results of running goseq three independent
times.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Note that we are intentionally adding a hyperG.selected column by reference
so that this information is kicked back to the caller multiGSEA function
and included in downstream reporting.</p>
<p><strong>This function is not meant to be called directly.</strong> It should only be
called internally within <code><a href='multiGSEA.html'>multiGSEA()</a></code>.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steve Lianoglou, Denali Therapeutics, Genentech.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


